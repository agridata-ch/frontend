on:
  workflow_call:

jobs:
  check-single-commit:
    name: Check Single Commit
    runs-on: ubuntu-latest
    timeout-minutes: 5
    steps:
      - name: Check number of commits in PR
        uses: actions/github-script@v7
        with:
          github-token: ${{ secrets.GITHUB_TOKEN }}
          script: |
            const pr = context.payload.pull_request;
             if (!pr) {
                console.log("Not a pull request event. Skipping commit check.");
                return;
            }
            const commits = await github.rest.pulls.listCommits({
              owner: context.repo.owner,
              repo: context.repo.repo,
              pull_number: pr.number,
            });
            const count = commits.data.length;
            if (count > 1) {
              core.setFailed(`PR has ${count} commits. Please squash to a single commit.`);
            } else {
              console.log("PR has a single commit. âœ…");
            }
