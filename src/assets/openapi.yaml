---
openapi: 3.1.0
components:
  schemas:
    AgisSearchParameters:
      type: object
      properties:
        personSearchParameters:
          $ref: "#/components/schemas/PersonSearchParameter"
    ConsentRequestDto:
      type: object
      required:
      - id
      description: Data transfer object representing a consent request
      properties:
        id:
          $ref: "#/components/schemas/UUID"
          type: string
          examples:
          - 3fa85f64-5717-4562-b3fc-2c963f66afa6
          description: Unique identifier of the consent request
        dataProducerId:
          type: string
          examples:
          - eb034f30-511b-4888-9b73-5572dd7d846c
          description: Unique identifier of the data producer
        stateCode:
          $ref: "#/components/schemas/ConsentRequestStateEnum"
          type: string
          examples:
          - PENDING
          description: Current state of the consent request
        lastStateChangeDate:
          type: string
          format: date
          examples:
          - 2025-06-16T11:04:51.823889
          description: Date and time when the state was changed last
        requestDate:
          $ref: "#/components/schemas/LocalDate"
          type: string
          examples:
          - 2025-05-19
          description: Date when the request was made
        dataRequest:
          type: object
          required:
          - stateCode
          description: Details of the underlying data request
          properties:
            id:
              $ref: "#/components/schemas/UUID"
              type: string
              examples:
              - 3fa85f64-5717-4562-b3fc-2c963f66afb7
              description: Unique identifier of the data request
            title:
              $ref: "#/components/schemas/DataRequestTitleDto"
              type: object
              description: Title of the data request
            description:
              $ref: "#/components/schemas/DataRequestDescriptionDto"
              type: object
              description: 'Description of the data request '
            purpose:
              $ref: "#/components/schemas/DataRequestPurposeDto"
              type: object
              description: Purpose of the data request
            products:
              type: object
              required:
              - id
              description: List of data products requested
              properties:
                id:
                  $ref: "#/components/schemas/UUID"
                  type: string
                  examples:
                  - 3fa85f64-5717-4562-b3fc-2c963f66afb7
                  description: Unique identifier of the product
                dataSourceSystemCode:
                  $ref: "#/components/schemas/DataSourceSystemEnum"
                  type: string
                  examples:
                  - AGIS
                  description: From which data source system this product originates
                name:
                  $ref: "#/components/schemas/TranslationDto"
                  type: object
                  examples:
                  - R01
                  description: How this product is categorized
                description:
                  $ref: "#/components/schemas/TranslationDto"
                  type: object
                  description: Description of the product
            stateCode:
              type:
              - string
              - object
              enum:
              - DRAFT
              - SUBMITTED
              description: State of the data request
            dataConsumerLegalName:
              type: string
              examples:
              - "Bio Suisse, Vereinigung Schweizer Biolandbau-Organisationen"
              maxLength: 255
              description: LegalName of the data consumer taken from the uid register
            dataConsumerDisplayName:
              type: string
              examples:
              - Bio Suisse
              maxLength: 255
              description: Shorter name of the data consumer defined by the data consumer
                used when displaying the request to the producer
            dataConsumerUid:
              type: integer
              examples:
              - 106506215
              description: Uid of the data consumer
              maximum: 16
            dataConsumerCity:
              type: string
              examples:
              - Basel
              maxLength: 120
              description: City of the data consumer
            dataConsumerZip:
              type: string
              examples:
              - "4052"
              maxLength: 10
              description: Zip code of the data consumer
            dataConsumerStreet:
              type: string
              examples:
              - Peter Merian-Str. 34
              maxLength: 255
              description: Street of the data consumer
            dataConsumerCountry:
              type: string
              examples:
              - CH
              maxLength: 2
              description: 2 letter country code of the data consumer
    ConsentRequestStateEnum:
      type: string
      enum:
      - GRANTED
      - OPENED
      - DECLINED
      description: Possible states of a consent request
    DataConsumerDto:
      type: object
      description: Data transfer object representing the consumer of requested data
      properties:
        id:
          $ref: "#/components/schemas/UUID"
          type: string
          examples:
          - a4479dd8-1c59-496a-a7ee-75be69bc1f7f
          description: id of the data consumer organization or individual
        name:
          type: string
          examples:
          - LabelOrganisation A
          description: Name of the data consumer organization or individual
    DataProductDto:
      type: object
      required:
      - id
      properties:
        id:
          $ref: "#/components/schemas/UUID"
          type: string
          examples:
          - 3fa85f64-5717-4562-b3fc-2c963f66afb7
          description: Unique identifier of the product
        dataSourceSystemCode:
          $ref: "#/components/schemas/DataSourceSystemEnum"
          type: string
          examples:
          - AGIS
          description: From which data source system this product originates
        name:
          $ref: "#/components/schemas/TranslationDto"
          type: object
          examples:
          - R01
          description: How this product is categorized
        description:
          $ref: "#/components/schemas/TranslationDto"
          type: object
          description: Description of the product
    DataRequestDescriptionDto:
      type: object
      properties:
        de:
          type: string
          examples:
          - "Ziel der Anfrage ist es, Informationen über Bodentypen und deren Qualitä\
            t zu erhalten, um fundierte Entscheidungen zur Fruchtfolge, Düngung und\
            \ nachhaltigen Bewirtschaftung treffen zu können."
          description: Description of the data request
        fr:
          type: string
          examples:
          - "L'objectif de la demande est d'obtenir des informations sur les types\
            \ de sols et leur qualité afin de prendre des décisions éclairées concernant\
            \ la rotation des cultures, la fertilisation et la gestion durable."
          description: Description de la demande de données
        it:
          type: string
          examples:
          - "L'obiettivo della richiesta è ottenere informazioni sui tipi di suolo\
            \ e sulla loro qualità per prendere decisioni informate sulla rotazione\
            \ delle colture, la fertilizzazione e la gestione sostenibile."
          description: Descrizione della richiesta di dati
    DataRequestDto:
      type: object
      required:
      - stateCode
      description: Details of the underlying data request
      properties:
        id:
          $ref: "#/components/schemas/UUID"
          type: string
          examples:
          - 3fa85f64-5717-4562-b3fc-2c963f66afb7
          description: Unique identifier of the data request
        title:
          $ref: "#/components/schemas/DataRequestTitleDto"
          type: object
          description: Title of the data request
        description:
          $ref: "#/components/schemas/DataRequestDescriptionDto"
          type: object
          description: 'Description of the data request '
        purpose:
          $ref: "#/components/schemas/DataRequestPurposeDto"
          type: object
          description: Purpose of the data request
        products:
          type: object
          required:
          - id
          description: List of data products requested
          properties:
            id:
              $ref: "#/components/schemas/UUID"
              type: string
              examples:
              - 3fa85f64-5717-4562-b3fc-2c963f66afb7
              description: Unique identifier of the product
            dataSourceSystemCode:
              $ref: "#/components/schemas/DataSourceSystemEnum"
              type: string
              examples:
              - AGIS
              description: From which data source system this product originates
            name:
              $ref: "#/components/schemas/TranslationDto"
              type: object
              examples:
              - R01
              description: How this product is categorized
            description:
              $ref: "#/components/schemas/TranslationDto"
              type: object
              description: Description of the product
        stateCode:
          type:
          - string
          - object
          enum:
          - DRAFT
          - SUBMITTED
          description: State of the data request
        dataConsumerLegalName:
          type: string
          examples:
          - "Bio Suisse, Vereinigung Schweizer Biolandbau-Organisationen"
          maxLength: 255
          description: LegalName of the data consumer taken from the uid register
        dataConsumerDisplayName:
          type: string
          examples:
          - Bio Suisse
          maxLength: 255
          description: Shorter name of the data consumer defined by the data consumer
            used when displaying the request to the producer
        dataConsumerUid:
          type: integer
          examples:
          - 106506215
          description: Uid of the data consumer
          maximum: 16
        dataConsumerCity:
          type: string
          examples:
          - Basel
          maxLength: 120
          description: City of the data consumer
        dataConsumerZip:
          type: string
          examples:
          - "4052"
          maxLength: 10
          description: Zip code of the data consumer
        dataConsumerStreet:
          type: string
          examples:
          - Peter Merian-Str. 34
          maxLength: 255
          description: Street of the data consumer
        dataConsumerCountry:
          type: string
          examples:
          - CH
          maxLength: 2
          description: 2 letter country code of the data consumer
    DataRequestPurposeDto:
      type: object
      properties:
        de:
          type: string
          examples:
          - Bewertung der Bodenqualität
        fr:
          type: string
          examples:
          - Évaluation de la qualité du sol
        it:
          type: string
          examples:
          - Valutazione della qualità del suolo
    DataRequestTitleDto:
      type: object
      properties:
        de:
          type: string
          examples:
          - Anfrage zu Bodentypen und Bodenqualitätsdaten
        fr:
          type: string
          examples:
          - Demande sur les types de sols et les données de qualité du sol
        it:
          type: string
          examples:
          - Richiesta sui tipi di suolo e sui dati sulla qualità del suolo
    DataRequestUpdateDto:
      type: object
      description: Data transfer object representing a data request
      properties:
        title:
          $ref: "#/components/schemas/DataRequestTitleDto"
          type: object
          description: Title of the data request
        description:
          $ref: "#/components/schemas/DataRequestDescriptionDto"
          type: object
          description: 'Description of the data request '
        purpose:
          $ref: "#/components/schemas/DataRequestPurposeDto"
          type: object
          description: Purpose of the data request
        dataConsumerDisplayName:
          type: string
          minLength: 3
          examples:
          - Bio Suisse
          maxLength: 255
          description: Shorter name of the data consumer defined by the data consumer
            used when displaying the request to the producer
        dataConsumerCity:
          type: string
          minLength: 2
          examples:
          - Basel
          maxLength: 120
          description: City of the data consumer
        dataConsumerZip:
          type: string
          minLength: 4
          examples:
          - "4052"
          maxLength: 10
          description: Zip code of the data consumer
        dataConsumerStreet:
          type: string
          minLength: 2
          examples:
          - Peter Merian-Str. 34
          maxLength: 120
          description: Street of the data consumer
        dataConsumerCountry:
          type: string
          minLength: 2
          examples:
          - CH
          maxLength: 2
          description: 2 letter country code of the data consumer
        products:
          type: array
          examples:
          - - c661ea48-106d-4d7a-a5d1-a9a6db48dd8c
          items:
            type: string
            format: uuid
            pattern: "[a-fA-F0-9]{8}-[a-fA-F0-9]{4}-[a-fA-F0-9]{4}-[a-fA-F0-9]{4}-[a-fA-F0-9]{12}"
          description: List of data products requested
    DataSourceSystemEnum:
      type: string
      enum:
      - AGIS
    ExceptionDto:
      type: object
      properties:
        message:
          type: string
        requestId:
          type: string
        type:
          $ref: "#/components/schemas/ExceptionEnum"
        debugMessage:
          type: string
    ExceptionEnum:
      type: string
      enum:
      - GENERIC
      - UID_MISSING
    LocalDate:
      type: string
      format: date
      examples:
      - 2022-03-10
    LocalDateTime:
      type: string
      format: date-time
      examples:
      - 2022-03-10T12:15:50
    PersonSearchParameter:
      type: object
      properties:
        ktIdP:
          type: string
          examples:
          - TG113657
    TranslationDto:
      type: object
      properties:
        de:
          type: string
          maxLength: 4000
        fr:
          type: string
          maxLength: 4000
        it:
          type: string
          maxLength: 4000
    UUID:
      type: string
      format: uuid
      pattern: "[a-fA-F0-9]{8}-[a-fA-F0-9]{4}-[a-fA-F0-9]{4}-[a-fA-F0-9]{4}-[a-fA-F0-9]{12}"
    UidRegisterAddressDto:
      type: object
      properties:
        street:
          type: string
        zip:
          type: string
        city:
          type: string
        country:
          type: string
    UidRegisterOrganisationDto:
      type: object
      properties:
        name:
          type: string
        legalName:
          type: string
        uid:
          type: integer
        address:
          $ref: "#/components/schemas/UidRegisterAddressDto"
  securitySchemes:
    SecurityScheme:
      type: openIdConnect
      description: Authentication
      openIdConnectUrl: http://localhost:6999/realms/agate/.well-known/openid-configuration
tags:
- name: Agis Test controller
  description: Used to test the Agis service integration
- name: Consent Requests
  description: "Handles creation, retrieval, and updates of consent requests by the\
    \ data producer"
- name: Data Requests
  description: "Handles creation, retrieval, and updates of data requests"
- name: Data products
  description: "Handles creation, retrieval, and updates of data products by the data\
    \ producer"
- name: Test Data
- name: Uid register search
  description: Enables searching for organisations in the UID register
paths:
  /api/agis/v1/data-requests:
    post:
      operationId: findRegisterData
      tags:
      - Agis Test controller
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/AgisSearchParameters"
        required: true
      responses:
        "200":
          description: OK
          content:
            application/json:
              schema: {}
        "401":
          description: Not Authorized
        "403":
          description: Not Allowed
        "400":
          description: Bad Request
        "404":
          description: The resource or element was not found
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ExceptionDto"
        "500":
          description: "Internal server error: unexpected error"
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ExceptionDto"
      summary: Find Register Data
      security:
      - SecurityScheme:
        - agridata.ch.Agridata_Admin
  /api/agreement/v1/consent-requests:
    get:
      operationId: getConsentRequests
      tags:
      - Consent Requests
      responses:
        "200":
          description: OK
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: "#/components/schemas/ConsentRequestDto"
        "401":
          description: Not Authorized
        "403":
          description: Not Allowed
        "404":
          description: The resource or element was not found
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ExceptionDto"
        "500":
          description: "Internal server error: unexpected error"
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ExceptionDto"
      summary: Get Consent Requests For Current Data Producer
      security:
      - SecurityScheme:
        - agridata.ch.Agridata_Einwilliger
  /api/agreement/v1/consent-requests/{id}/status:
    put:
      operationId: updateConsentRequestStatus
      tags:
      - Consent Requests
      parameters:
      - description: ID of the consent request
        required: true
        name: id
        in: path
        schema:
          $ref: "#/components/schemas/UUID"
      requestBody:
        description: New status of the consent request
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/ConsentRequestStateEnum"
        required: true
      responses:
        "204":
          description: No Content
        "401":
          description: Not Authorized
        "403":
          description: Not Allowed
        "404":
          description: The resource or element was not found
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ExceptionDto"
        "500":
          description: "Internal server error: unexpected error"
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ExceptionDto"
      summary: Update Consent Request State For Current Data Producer
      security:
      - SecurityScheme:
        - agridata.ch.Agridata_Einwilliger
  /api/agreement/v1/data-requests:
    get:
      operationId: getDataRequests
      tags:
      - Data Requests
      responses:
        "200":
          description: OK
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: "#/components/schemas/DataRequestDto"
        "401":
          description: Not Authorized
        "403":
          description: Not Allowed
        "404":
          description: The resource or element was not found
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ExceptionDto"
        "500":
          description: "Internal server error: unexpected error"
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ExceptionDto"
      summary: Get Data Requests
      security:
      - SecurityScheme:
        - agridata.ch.Agridata_Admin
        - agridata.ch.Agridata_Datenbezueger
    post:
      operationId: createDataRequestDraft
      tags:
      - Data Requests
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/DataRequestUpdateDto"
        required: true
      responses:
        "200":
          description: OK
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/DataRequestDto"
        "401":
          description: Not Authorized
        "403":
          description: Not Allowed
        "400":
          description: Bad Request
        "404":
          description: The resource or element was not found
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ExceptionDto"
        "500":
          description: "Internal server error: unexpected error"
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ExceptionDto"
      summary: Create Data Request Draft
      security:
      - SecurityScheme:
        - agridata.ch.Agridata_Admin
        - agridata.ch.Agridata_Datenbezueger
  /api/agreement/v1/data-requests/{id}:
    put:
      operationId: updateDataRequestDraft
      tags:
      - Data Requests
      parameters:
      - name: id
        in: path
        required: true
        schema:
          $ref: "#/components/schemas/UUID"
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/DataRequestUpdateDto"
        required: true
      responses:
        "200":
          description: OK
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/DataRequestDto"
        "401":
          description: Not Authorized
        "403":
          description: Not Allowed
        "400":
          description: Bad Request
        "404":
          description: The resource or element was not found
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ExceptionDto"
        "500":
          description: "Internal server error: unexpected error"
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ExceptionDto"
      summary: Update Data Request Draft
      security:
      - SecurityScheme:
        - agridata.ch.Agridata_Admin
        - agridata.ch.Agridata_Datenbezueger
    get:
      operationId: getDataRequest
      tags:
      - Data Requests
      parameters:
      - name: id
        in: path
        required: true
        schema:
          $ref: "#/components/schemas/UUID"
      responses:
        "200":
          description: OK
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/DataRequestDto"
        "401":
          description: Not Authorized
        "403":
          description: Not Allowed
        "404":
          description: The resource or element was not found
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ExceptionDto"
        "500":
          description: "Internal server error: unexpected error"
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ExceptionDto"
      summary: Get Data Request
      security:
      - SecurityScheme:
        - agridata.ch.Agridata_Admin
        - agridata.ch.Agridata_Datenbezueger
  /api/agreement/v1/data-requests/{id}/submit:
    post:
      operationId: submitDataRequest
      tags:
      - Data Requests
      parameters:
      - name: id
        in: path
        required: true
        schema:
          $ref: "#/components/schemas/UUID"
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/DataRequestUpdateDto"
        required: true
      responses:
        "200":
          description: OK
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/DataRequestDto"
        "401":
          description: Not Authorized
        "403":
          description: Not Allowed
        "400":
          description: Bad Request
        "404":
          description: The resource or element was not found
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ExceptionDto"
        "500":
          description: "Internal server error: unexpected error"
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ExceptionDto"
      summary: Submit Data Request
      security:
      - SecurityScheme:
        - agridata.ch.Agridata_Admin
        - agridata.ch.Agridata_Datenbezueger
  /api/products/v1:
    get:
      operationId: getDataProducts
      tags:
      - Data products
      responses:
        "200":
          description: OK
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: "#/components/schemas/DataProductDto"
        "401":
          description: Not Authorized
        "403":
          description: Not Allowed
        "404":
          description: The resource or element was not found
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ExceptionDto"
        "500":
          description: "Internal server error: unexpected error"
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ExceptionDto"
      summary: Get Data Products
      security:
      - SecurityScheme:
        - agridata.ch.Agridata_Einwilliger
        - agridata.ch.Agridata_Datenbezueger
        - agridata.ch.Agridata_Admin
        - agridata.ch.Agridata_Datenanbieter
  /api/test-data/reset:
    post:
      operationId: resetTestData
      tags:
      - Test Data
      responses:
        "200":
          description: OK
        "401":
          description: Not Authorized
        "403":
          description: Not Allowed
        "404":
          description: The resource or element was not found
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ExceptionDto"
        "500":
          description: "Internal server error: unexpected error"
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ExceptionDto"
      summary: Reset Test Data
      security:
      - SecurityScheme: []
  /api/uid-register/v1/search:
    get:
      operationId: getByUidOfCurrentUser
      tags:
      - Uid register search
      responses:
        "200":
          description: OK
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/UidRegisterOrganisationDto"
        "401":
          description: Not Authorized
        "403":
          description: Not Allowed
        "404":
          description: The resource or element was not found
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ExceptionDto"
        "500":
          description: "Internal server error: unexpected error"
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ExceptionDto"
      summary: Get By Uid Of Current User
      security:
      - SecurityScheme: []
  /api/uid-register/v1/search/{uid}:
    get:
      operationId: getByUid
      tags:
      - Uid register search
      parameters:
      - description: UID of the organisation
        example: 106506215
        required: true
        name: uid
        in: path
        schema:
          type: integer
      responses:
        "200":
          description: OK
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/UidRegisterOrganisationDto"
        "401":
          description: Not Authorized
        "403":
          description: Not Allowed
        "404":
          description: The resource or element was not found
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ExceptionDto"
        "500":
          description: "Internal server error: unexpected error"
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ExceptionDto"
      summary: Get By Uid
      security:
      - SecurityScheme: []
  /q/info:
    get:
      responses:
        "200":
          description: OK
          content:
            application/json:
              schema:
                type: object
                additionalProperties:
                  type: string
        "404":
          description: The resource or element was not found
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ExceptionDto"
        "500":
          description: "Internal server error: unexpected error"
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ExceptionDto"
      summary: Info
      tags:
      - Info Resource
  /q/info/schema:
    get:
      responses:
        "200":
          description: OK
          content:
            application/json:
              schema:
                type: string
        "404":
          description: The resource or element was not found
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ExceptionDto"
        "500":
          description: "Internal server error: unexpected error"
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ExceptionDto"
      summary: Schema
      tags:
      - Info Resource
info:
  title: agridata.ch API
  version: 1.0.0-rc.38
  description: This API handles data and consent requests for agridata.ch.
